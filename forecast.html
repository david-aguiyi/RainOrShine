<!DOCTYPE html>
<html>
<head>
  <title>Weather Forecast</title>
</head>
<body>
  <h1>Weather Forecast</h1>
  <form id="cityForm">
    <input
      type="text"
      id="cityInput"
      placeholder="Enter city/country name" />
    <button type="submit">Get Forecast</button>
  </form>
  <div id="forecast"></div>
  <script>
    const apiKey = "npn0ofydsxc70vmz60bg10uxosy5arpar03ami77";
    let city = ""; // Initialize an empty city variable

    const getWeatherForecast = (city) => {
      const apiUrl = `https://www.meteosource.com/api/v1/free/point?place_id=${city}&sections=all&timezone=UTC&language=en&units=metric&key=${apiKey}`;

      fetch(apiUrl)
        .then((response) => {
          if (!response.ok) {
            throw new Error("Network response was not ok");
          }
          return response.json();
        })
        .then((data) => {
          if (!data || !data.daily || !data.daily.data || !Array.isArray(data.daily.data)) {
            throw new Error("Invalid data format or no weather forecast available.");
          }

          const forecastList = data.daily.data;
          const forecastDiv = document.getElementById("forecast");
          forecastDiv.innerHTML = "";

          forecastList.forEach((forecast) => {
            const date = new Date(forecast.day);
            const options = { weekday: 'short', year: 'numeric', month: 'long', day: 'numeric' };
            const formattedDate = date.toLocaleDateString(undefined, options);
            const weather = forecast.weather;
            const temperatureMin = forecast.all_day.temperature_min;
            const temperatureMax = forecast.all_day.temperature_max;
            const windSpeed = forecast.all_day.wind.speed;
            const windDirection = forecast.all_day.wind.dir;
            const cloudCover = forecast.all_day.cloud_cover.total;
            const precipitation = forecast.all_day.precipitation.total;
            const forecastItem = document.createElement("div");
            forecastItem.textContent = `Date: ${formattedDate}, Weather: ${weather}, Min Temperature: ${temperatureMin}°C, Max Temperature: ${temperatureMax}°C, Wind Speed: ${windSpeed} km/h, Wind Direction: ${windDirection}, Precipitation: ${precipitation} mm`;
            forecastDiv.appendChild(forecastItem);
          });
        })
        .catch((error) => {
          console.error("Error:", error);
          alert("City not found or no weather forecast available for the specified city.");
        });
    };

    const cityForm = document.getElementById("cityForm");
    const cityInput = document.getElementById("cityInput");

    cityForm.addEventListener("submit", (e) => {
      e.preventDefault();
      city = cityInput.value.trim();
      if (city !== "") {
        getWeatherForecast(city);
      }
    });
  </script>
</body>
</html>
